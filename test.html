<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimo Post su Bluesky</title>
    <style>
        #bluesky-box {
            border: 1px solid #ccc;
            padding: 15px;
            width: 400px;
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            border-radius: 8px;
        }
        #bluesky-box a {
            text-decoration: none;
            color: #007AFF;
        }
    </style>
</head>
<body>

    <div id="bluesky-box">Caricamento ultimo post...</div>

    <script>
        async function fetchLatestBlueskyPost(username) {
            const url = `https://public.api.bsky.app/xrpc/app.bsky.feed.getAuthorFeed?actor=${username}&limit=1`;

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error("Errore nel recupero del post");

                const data = await response.json();
                const post = data.feed[0]?.post;
                
                if (!post) {
                    document.getElementById("bluesky-box").innerText = "Nessun post trovato.";
                    return;
                }

                const content = post.record.text;
                const timestamp = new Date(post.record.createdAt).toLocaleString();
                const postUrl = `https://bsky.app/profile/${username}/post/${post.uri.split('/').pop()}`;

                document.getElementById("bluesky-box").innerHTML = `
                    <p>${content}</p>
                    <small>ðŸ“… ${timestamp}</small><br>
                    <a href="${postUrl}" target="_blank">ðŸ”— Visualizza su Bluesky</a>
                `;
            } catch (error) {
                document.getElementById("bluesky-box").innerText = "Errore nel caricamento del post.";
            }
        }

        fetchLatestBlueskyPost("rtug.bsky.social"); // Sostituisci con il nome utente desiderato
    </script>

</body>
</html>